<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<link th:replace="common/fragment::base"/>
<script type="text/javascript" th:inline="javascript">
var list = [[${list}]];
window.onload = function() {
	page(list, "demo/list");
}

</script>
</head>
<body>
<div id="page">
	<div>
		<label style="font-size: 16px;font-weight: bold;">ğŸ”–æˆ‘æ˜¯è§„åˆ™æ¶ˆæ¯</label>
		<button onclick="add.show()">æ–°å¢</button>
		<input type="text" v-model="pojo.demoName" maxlength="32">
		<button @click="gotoPage(1)">æœç´¢</button>
	</div>
	<table class="tableTemplate">
	<tr>
		<th class="active" @click="sortPage('demo_id', sortType['demo_id'])">DEMO_ID<span :class="sortType['demo_id']"></span></th>
		<th class="active" @click="sortPage('demo_name', sortType['demo_name'])">DEMO_NAME<span :class="sortType['demo_name']"></span></th>
		<th>DEMO_TYPE</th>
	</tr>
	<tr v-for="item in list">
		<td>{{item.demoId}}</td>
		<td>{{item.demoName}}</td>
		<td>{{item.demoType}}</td>
	</tr>
	</table>
	<div th:replace="common/fragment::page"/>
</div>

<div id="add"><add v-if="showLoading" :pojo="pojo" @ok="ok" @close="hide()" :validate="validate"></div>
<script type="text/x-template" id="add-template">
<div class="modal-mask">
<div class="modal-wrapper">
	<div class="modal-container" style="width:500px">
		<div class="modal-header"><h3>è§„åˆ™</h3></div>
		<div class="modal-body">
			<table>
				<tr>
					<th style="width:100px">è§„åˆ™åç§°</th>
					<td><input type="text" v-model="pojo.demoName" maxlength="32"><span style="color:red">{{validate.demoName}}</span></td>
				</tr>
				<tr>
					<th>è§„åˆ™åç§°</th>
					<td><input type="text" v-model="pojo.demoType" maxlength="3"><span style="color:red">{{validate.demoType}}</td>
				</tr>
				<tr>
					<th>date</th>
					<td><input type="date" v-model="pojo.demoDate" maxlength="32"><span style="color:red"></td>
				</tr>
			</table>
        </div>
		<div class="modal-footer">&nbsp;
			<div class="modal-default-button">
				<button @click="$emit('close')">å…³é—­</button>
				<button @click="$emit('ok')">ç¡®å®š</button>
			</div>
		</div>
	</div>
</div>
</div>
</script>

<script type="text/javascript">

Vue.component('add', {template: '#add-template', props: {pojo:Object, validate:Object}});
add = new Vue({
	el: '#add',
	data: {
      	showLoading:false,
      	pojo:{},
      	validateBoolean:false
	},
	computed: {
		validate:function() {
			if (this.validateBoolean == false) return {};
			return {
				demoName:V.notNull(this.pojo.demoName), 
				demoType:V.notNull(this.pojo.demoType) || V.isNum(this.pojo.demoType)
			}
		},
		isValid: function () {
			for (o in this.validate) {
				if (this.validate[o] != "") return false;
			}
			return true;
		}
	},
	methods: {
      	show:function() {this.showLoading = true;},
      	hide:function() {this.showLoading = false;},
      	ok:function() {
      		this.validateBoolean = true;
      		if (!this.isValid) return;
      		loading.show();
            axios.post(contextPath + "demo/insert", Qs.stringify(this.pojo)).then(function(res) {
            	loading.hide();
            	if (res.data.code == 0) {
            		add.hide();
            		page.gotoPage(1);
            	}
            });
      	}
	}
})
</script>


<div th:replace="common/fragment::commonDiv"/>
</body>
</html>

