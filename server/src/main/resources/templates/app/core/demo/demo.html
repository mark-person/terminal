<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<link th:replace="common/fragment::base"/>
<script type="text/javascript" th:inline="javascript">
var list = [[${list}]];
window.onload = function() {
	page(list, "demo/list");
}
</script>

<style type="text/css">
.title {font-size: 16px;font-weight: bold;}
.title:before {content:"🔖";}

.error {color:red}
</style>
</head>
<body>
<div id="page">
	<div>
		<label class="title" style="">我是规则消息</label>
		<button onclick="add.pojo = {};add.showModal = true">新增</button>
		<input type="text" v-model="pojo.demoName" maxlength="32">
		<button @click="gotoPage(1)">搜索</button>
	</div>
	<table class="tableTemplate">
	<tr>
		<th class="active" @click="sortPage('demo_id', sortType['demo_id'])">DEMO_ID<span :class="sortType['demo_id']"></span></th>
		<th class="active" @click="sortPage('demo_name', sortType['demo_name'])">DEMO_NAME<span :class="sortType['demo_name']"></span></th>
		<th>DEMO_TYPE</th>
		<th>ACTIOLN</th>
	</tr>
	<tr v-for="item in list">
		<td>{{item.demoId}}</td>
		<td>{{item.demoName}}</td>
		<td>{{item.demoType}}</td>
		<td><a :href="'javascript:editDemo(' + item.demoId + ')'">修改</a></td>
	</tr>
	</table>
	<div th:replace="common/fragment::page"/>
</div>


<div id="add" class="blockTemplate">
<add v-if="showModal" :pojo="pojo" @ok="ok" @close="showModal = false" :validate="validate">
<table slot="body">
	<tr>
		<th style="width:100px">规则名称</th>
		<td><input type="text" v-model="pojo.demoName" maxlength="32"><span class="error">{{validate.demoName}}</span></td>
	</tr>
	<tr>
		<th>规则名称</th>
		<td><input type="text" v-model="pojo.demoType" maxlength="2"><span class="error">{{validate.demoType}}</td>
	</tr>
	<tr>
		<th>提醒日期</th>
		<td><input type="date" v-model="pojo.demoDate"><span class="error"></td>
	</tr>
</table>
</add>
</div>
<script type="text/javascript">
var validateFun = function(pojo) {
	return {
		demoName:V.notNull(pojo.demoName),
		demoType:V.notNull(pojo.demoType) || V.isNum(pojo.demoType)
	}
}
var add = modal("add", validateFun, "demo/insert");
</script>


<div id="edit" class="blockTemplate">
<add v-if="showModal" :pojo="pojo" @ok="ok" @close="showModal = false" :validate="validate">
<table slot="body">
	<tr>
		<th style="width:100px">规则名称</th>
		<td><input type="text" v-model="pojo.demoName" maxlength="32"><span class="error">{{validate.demoName}}</span></td>
	</tr>
	<tr>
		<th>规则名称</th>
		<td><input type="text" v-model="pojo.demoType" maxlength="2"><span class="error">{{validate.demoType}}</td>
	</tr>
	<tr>
		<th>提醒日期</th>
		<td><input type="date" v-model="pojo.demoDate"><span class="error"></td>
	</tr>
</table>
</add>
</div>
<script type="text/javascript">

var edit = modal("edit", validateFun, "demo/update");

function editDemo(id) {
	loading.show();
	axios.post(contextPath + "demo/get", "id=" + id).then(function(res) {
		loading.hide();
		if (res.data.code == 0) {
			edit.pojo = res.data.pojo;
			edit.showModal = true;
		}
	})
}

</script>




<div th:replace="common/fragment::commonDiv"/>
</body>
</html>

