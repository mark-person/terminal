<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<title></title>
<script type="text/javascript" th:inline="javascript">var contextPath = [[@{/}]];</script>
<script type="text/javascript" th:src="@{/static/vue/vue.min.js}"></script>
<script type="text/javascript" th:src="@{/static/vue/axios.min.js}"></script>
<link rel="stylesheet" th:href="@{/static/terminal/demo/demo.css}">

<script type="text/javascript" th:inline="javascript">

var list = [[${list}]];


window.onload = function() {
	var pageTable = new Vue({
	    el:'#myTable',
	    data:{
	        list:list.list,
	        sortType:[],
	        columns:[{t:'消息类型'}, {t:'提醒方式'}]
	    },
	    methods: {
	    	sortPage:function(orderName, orderType) {
	    		orderType = (orderType == 'asc' ? 'desc' : 'asc');
	    		pageTable.sortType[orderName] = orderType;
	    		pagination.gotoPage(1, orderName, orderType);
	    	}
	    }
	});
	pagination = new Vue({
	    el:'#myPagination',
	    data:{
	    	totalNum:Math.ceil(list.page.totalRows/list.page.pageSize),
	    	totalRows:list.page.totalRows,
	    	pageNumber:list.page.pageNumber
	    },
	    methods:{
	    	gotoPage:function(n, orderName, orderType) {
	    		var f = new FormData();
	    		f.append("pageNumber", n);
	    		f.append("orderName", orderName);
	    		f.append("orderType", orderType);
	            axios.post(contextPath + "demo/list", f).then(function(res) {
	            	var r = res.data;
	            	pageTable.list = r.list;
	            	pagination.totalNum = Math.ceil(r.page.totalRows/r.page.pageSize);
	            	pagination.totalRows = r.page.totalRows;
	            	pagination.pageNumber = r.page.pageNumber;
	            });
	    	}
	    }
	});
}

function query() {
	pagination.gotoPage(2);
}

function getSortType(type) {
	if (!type) {
		return "arrow";
	}
	else  {
		return type;
	}
}


</script>
<style>


</style>
</head>

<body>


<div>
<input type="text">
<button onclick="query()">test</button>
</div>

<table id="myTable">
<thead>
	<!--  
	<tr>
		<th class="active" @click="sortPage('demo_id', sortType['demo_id'])">消息类型<span :class="getSortType(sortType['demo_id'])"></span></th>
		<th class="active" @click="sortPage('demo_name', sortType['demo_name'])">提醒方式<span :class="sortType['demo_name']"></span></th>
	</tr>
	-->
	
	<tr>
		<th v-for="item in columns" @click="sortPage('demo_id', sortType['demo_id'])">{{item}}</th>
	</tr>
</thead>
<tbody>
	<tr v-for="item in list">
		<td>{{item.demoId}}</td><td>{{item.demoName}}</td>
	</tr>
</tbody>
</table>
<nav id="myPagination" class="pagination">
	<ul>
		<li v-if="pageNumber != 1" @click="gotoPage(1)"><span>«</span</li>
		<li v-if="pageNumber - 2 >= 1" @click="gotoPage(pageNumber - 2)"><span>{{pageNumber - 2}}</span></li>
		<li v-if="pageNumber - 1 >= 1" @click="gotoPage(pageNumber - 1)"><span>{{pageNumber - 1}}</span></li>
		<li class="active"><span>{{pageNumber}}</span></li>
		<li v-if="pageNumber + 1 <= totalNum" @click="gotoPage(pageNumber + 1)"><span>{{pageNumber + 1}}</span></li>
		<li v-if="pageNumber + 2 <= totalNum" @click="gotoPage(pageNumber + 2)"><span>{{pageNumber + 2}}</span></li>
		<li v-if="pageNumber != totalNum" @click="gotoPage(totalNum)"><span>»</span></li>
	</ul>
	<select>
		<option value="3" selected="selected">3条</option><option value="20">20条</option><option value="50">50条</option>
	</select>
	<div>共<b>{{totalRows}}</b>条记录</div>
</nav>

</body>

</html>

